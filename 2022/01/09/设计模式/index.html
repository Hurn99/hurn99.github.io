<!DOCTYPE html><html lang="zh"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=0.5"><link rel="stylesheet" href="/css/post.css"><link rel="icon" href="/img/favicon.png"><title>设计模式</title><meta name="generator" content="Hexo 5.4.0"><link rel="stylesheet" href="/css/prism.css" type="text/css"></head><body>　　<div class="inner"><h2>设计模式</h2><h2 id="1-观察者模式"><a href="#1-观察者模式" class="headerlink" title="1. 观察者模式"></a>1. 观察者模式</h2><ul>
<li>定义对象间的一种一对多的依赖关系，当一个对象的状态发生改变时，<code>所有依赖的对象都得到通知并自动更新</code>。</li>
<li>将功能分割后，不用再维护各组件间的统一性，使用此模式动态更新。</li>
<li>适用于一个对象改变后需要通知其他对象的场景。</li>
<li>案例，模仿热水器的工作</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> abc <span class="keyword">import</span> abstractmethod, ABCMeta</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 监听模式 ，热水器是被监听 ， 热水模式为监听 ,温度为监听属性</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WaterHeater</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.__observers = []</span><br><span class="line">        self.__temperature = <span class="number">0</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;【初始化】热水器开始工作啦~~~&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_temperature</span>(<span class="params">self, t</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span> &lt; t &lt;= <span class="number">200</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;【设置温度】将温度设置为：&quot;</span>, t)</span><br><span class="line">            self.__temperature = t</span><br><span class="line">            self.update()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_temperature</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__temperature</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_observers</span>(<span class="params">self, observer</span>):</span></span><br><span class="line">        self.__observers.append(observer)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(self.__observers) &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">for</span> o <span class="keyword">in</span> self.__observers:</span><br><span class="line">                <span class="comment"># 把自己传递过去</span></span><br><span class="line">                o.update(self)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Observer</span>(<span class="params">metaclass=ABCMeta</span>):</span></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update</span>(<span class="params">self, waterHeater</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WashingMode</span>(<span class="params">Observer</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update</span>(<span class="params">self, waterHeater</span>):</span></span><br><span class="line">        <span class="keyword">if</span> waterHeater.get_temperature() &gt; <span class="number">70</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;【洗澡模式】 开始洗白白~ &quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DrinkingMode</span>(<span class="params">Observer</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update</span>(<span class="params">self, waterHeater</span>):</span></span><br><span class="line">        <span class="keyword">if</span> waterHeater.get_temperature() &gt;= <span class="number">100</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;【饮用模式】 水可以喝了~ &quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PlayingMode</span>(<span class="params">Observer</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update</span>(<span class="params">self, waterHeater</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="number">30</span> &lt; waterHeater.get_temperature() &lt; <span class="number">50</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;【快乐模式】 尽情嗨皮吧~ &quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    myWaterHeater = WaterHeater()</span><br><span class="line">    myWaterHeater.add_observers(WashingMode())</span><br><span class="line">    myWaterHeater.add_observers(DrinkingMode())</span><br><span class="line">    myWaterHeater.add_observers(PlayingMode())</span><br><span class="line"></span><br><span class="line">    myWaterHeater.set_temperature(<span class="number">10</span>)</span><br><span class="line">    myWaterHeater.set_temperature(<span class="number">40</span>)</span><br><span class="line">    myWaterHeater.set_temperature(<span class="number">70</span>)</span><br><span class="line">    myWaterHeater.set_temperature(<span class="number">90</span>)</span><br><span class="line">    myWaterHeater.set_temperature(<span class="number">110</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># output</span></span><br><span class="line">【初始化】热水器开始工作啦~~~</span><br><span class="line">【设置温度】将温度设置为： <span class="number">10</span></span><br><span class="line">【设置温度】将温度设置为： <span class="number">40</span></span><br><span class="line">【快乐模式】 尽情嗨皮吧~ </span><br><span class="line">【设置温度】将温度设置为： <span class="number">70</span></span><br><span class="line">【设置温度】将温度设置为： <span class="number">90</span></span><br><span class="line">【洗澡模式】 开始洗白白~ </span><br><span class="line">【设置温度】将温度设置为： <span class="number">110</span></span><br><span class="line">【洗澡模式】 开始洗白白~ </span><br><span class="line">【饮用模式】 水可以喝了~ </span><br></pre></td></tr></table></figure>

<ul>
<li>主要代码  ，设置被监听的属性，如果改变则更新同步到所有的监听</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">set_temperature</span>(<span class="params">self, t</span>):</span></span><br><span class="line">    <span class="keyword">if</span> <span class="number">0</span> &lt; t &lt;= <span class="number">200</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;【设置温度】将温度设置为：&quot;</span>, t)</span><br><span class="line">        self.__temperature = t</span><br><span class="line">        self.update()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update</span>(<span class="params">self</span>):</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(self.__observers) &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">for</span> o <span class="keyword">in</span> self.__observers:</span><br><span class="line">            <span class="comment"># 把自己传递过去</span></span><br><span class="line">            o.update(self)</span><br></pre></td></tr></table></figure>



<ul>
<li><code>监听者模式的要点是搞清楚 谁是监听者，谁是被监听的对象， 被监听对象的属性是什么，一旦被监听者的属性发生改变则立即通知监听者（使用统一的接口update）</code></li>
<li>监听者模式的框架：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> abc <span class="keyword">import</span> ABCMeta, abstractmethod</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Observable</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.__observers = []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_observer</span>(<span class="params">self, observer</span>):</span></span><br><span class="line">        self.__observers.append(observer)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">remove_observer</span>(<span class="params">self, observer</span>):</span></span><br><span class="line">        self.__observers.remove(observer)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">notifies</span>(<span class="params">self, <span class="built_in">object</span>=<span class="number">0</span></span>):</span></span><br><span class="line">        <span class="keyword">for</span> o <span class="keyword">in</span> self.__observers:</span><br><span class="line">            o.update(self, <span class="built_in">object</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Observer</span>(<span class="params">metaclass=ABCMeta</span>):</span></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update</span>(<span class="params">self, observable, <span class="built_in">object</span></span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>案例，用监听者模式做异地登录检测。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 判断用户是否异常登录，如果正常登录则发送短信、邮件通知</span></span><br><span class="line"><span class="comment"># 用户为被观察者，被观察的属性为登录状态（是否异地登录），观察者（短信、邮件）</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Account</span>(<span class="params">Observable</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.__last_login_ip = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_lastip</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__last_login_ip</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">login</span>(<span class="params">self, ip, user</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[登录成功] 您的登录IP为: &#123;&#125; ,用户名为: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(ip, user))</span><br><span class="line">        <span class="keyword">if</span> self.is_lastip(ip):</span><br><span class="line">            self.notifies(self)</span><br><span class="line">        self.__last_login_ip = ip</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_lastip</span>(<span class="params">self, ip</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.__last_login_ip != <span class="string">&#x27;&#x27;</span> <span class="keyword">and</span> self.__last_login_ip != ip:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SMS</span>(<span class="params">Observer</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update</span>(<span class="params">self, observable, <span class="built_in">object</span></span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[短信通知] 您的账户异地登录，上次登录的IP为： &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">object</span>.get_lastip()))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Email</span>(<span class="params">Observer</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update</span>(<span class="params">self, observable, <span class="built_in">object</span></span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[邮件通知] 您的账户异常登录，上次登录的IP为： &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">object</span>.get_lastip()))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    account = Account()</span><br><span class="line">    account.add_observer(SMS())</span><br><span class="line">    account.add_observer(Email())</span><br><span class="line">    account.login(<span class="string">&#x27;1.1.1.1&#x27;</span>, <span class="string">&#x27;tom&#x27;</span>)</span><br><span class="line">    account.login(<span class="string">&#x27;2.2.2.2&#x27;</span>, <span class="string">&#x27;tom&#x27;</span>)</span><br><span class="line">    account.login(<span class="string">&#x27;2.2.2.2&#x27;</span>, <span class="string">&#x27;tom&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="comment"># output </span></span><br><span class="line">[登录成功] 您的登录IP为: <span class="number">1.1</span><span class="number">.1</span><span class="number">.1</span> ,用户名为: tom</span><br><span class="line">[登录成功] 您的登录IP为: <span class="number">2.2</span><span class="number">.2</span><span class="number">.2</span> ,用户名为: tom</span><br><span class="line">[短信通知] 您的账户异地登录，上次登录的IP为： <span class="number">1.1</span><span class="number">.1</span><span class="number">.1</span></span><br><span class="line">[邮件通知] 您的账户异常登录，上次登录的IP为： <span class="number">1.1</span><span class="number">.1</span><span class="number">.1</span></span><br><span class="line">[登录成功] 您的登录IP为: <span class="number">2.2</span><span class="number">.2</span><span class="number">.2</span> ,用户名为: tom</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="2-状态模式"><a href="#2-状态模式" class="headerlink" title="2. 状态模式"></a>2. 状态模式</h2><ul>
<li><p>状态模式让类可以无缝切换状态，各状态有统一的接口不同的行为。</p>
</li>
<li><p>示例，模仿水在固态、气态、液态切换</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> abc <span class="keyword">import</span> ABCMeta, abstractmethod</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Water</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.__temperatrue = <span class="number">0</span></span><br><span class="line">        self.__state = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">change_state</span>(<span class="params">self, state</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.state <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;初始化状态为：&quot;</span>, state.get_name())</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;状态由&quot;</span>, self.__state.get_name(), <span class="string">&quot;变更为：&quot;</span>, state.get_name())</span><br><span class="line"></span><br><span class="line">        self.__state = state</span><br><span class="line">	</span><br><span class="line">    <span class="comment"># 属性改变时切换状态</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_temperature</span>(<span class="params">self, temperature</span>):</span></span><br><span class="line">        <span class="keyword">if</span> temperature &lt;= <span class="number">0</span>:</span><br><span class="line">            self.change_state(SolidState())</span><br><span class="line">        <span class="keyword">elif</span> temperature &lt;= <span class="number">100</span>:</span><br><span class="line">            self.change_state(LiquidState())</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.change_state(GaseousState())</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_temperatrue</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__temperatrue</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">behavior</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.__state.behavior(self)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">State</span>(<span class="params">metaclass=ABCMeta</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.name = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">behavior</span>(<span class="params">self, water</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SolidState</span>(<span class="params">State</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.name = <span class="string">&quot;固态&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">behavior</span>(<span class="params">self, water</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;我是固态，当前温度为：&quot;</span>, water.get_temperatrue())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LiquidState</span>(<span class="params">State</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.name = <span class="string">&quot;液态&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">behavior</span>(<span class="params">self, water</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;我是液态，当前温度为：&quot;</span>, water.get_temperatrue())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GaseousState</span>(<span class="params">State</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.name = <span class="string">&quot;气态&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">behavior</span>(<span class="params">self, water</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;我是液态，当前温度为：&quot;</span>, water.get_temperatrue())</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>主要代码，提供一个状态接口，有统一的行为，当属性更变时即可无缝切换。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Water</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.__temperatrue = <span class="number">0</span></span><br><span class="line">        self.__state = <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">    <span class="comment"># 属性改变时切换状态</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_temperature</span>(<span class="params">self, temperature</span>):</span></span><br><span class="line">        <span class="keyword">if</span> temperature &lt;= <span class="number">0</span>:</span><br><span class="line">            self.change_state(SolidState())</span><br><span class="line">        <span class="keyword">elif</span> temperature &lt;= <span class="number">100</span>:</span><br><span class="line">            self.change_state(LiquidState())</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.change_state(GaseousState())</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">behavior</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.__state.behavior(self)</span><br></pre></td></tr></table></figure></li>
<li><p>基于框架的代码实现。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> abc <span class="keyword">import</span> ABCMeta, abstractmethod</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Context</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.__states = []</span><br><span class="line">        self.__state_info = <span class="literal">None</span></span><br><span class="line">        self.__current_state = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_state</span>(<span class="params">self, state</span>):</span></span><br><span class="line">        <span class="keyword">if</span> state <span class="keyword">not</span> <span class="keyword">in</span> self.__states:</span><br><span class="line">            self.__states.append(state)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">change_state</span>(<span class="params">self, state</span>):</span></span><br><span class="line">        self.__current_state = state</span><br><span class="line">        self.add_state(state)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_state_info</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">for</span> state <span class="keyword">in</span> self.__states:</span><br><span class="line">            <span class="comment"># 降低耦合，把判断条件交给子类区判断</span></span><br><span class="line">            <span class="keyword">if</span> state.is_match(self.__state_info):</span><br><span class="line">                self.change_state(state)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">behavior</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.__current_state.behavior(self)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">State</span>(<span class="params">metaclass=ABCMeta</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_name</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_match</span>(<span class="params">self, state_info</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">behavior</span>(<span class="params">self, context</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="3-中介模式"><a href="#3-中介模式" class="headerlink" title="3. 中介模式"></a>3. 中介模式</h2><ul>
<li><p>中介模式，适用1对多的情况，将中间复杂的关系交给中介处理，个体1只需要处理与中介的逻辑即可。</p>
</li>
<li><p>中介找房案例</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HouseInfo</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, area, price, has_window, has_bathroom, has_kitchen, address, owner</span>):</span></span><br><span class="line">        self.__area = area</span><br><span class="line">        self.__price = price</span><br><span class="line">        self.__has_window = has_window</span><br><span class="line">        self.__has_bathroom = has_bathroom</span><br><span class="line">        self.__has_kitchen = has_kitchen</span><br><span class="line">        self.__address = address</span><br><span class="line">        self.__owner = owner</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_address</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__address</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_onwer_name</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__owner.get_name()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">show_info</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;面积： &quot;</span> + <span class="built_in">str</span>(self.__area) + <span class="string">&quot;平方米&quot;</span> +</span><br><span class="line">              <span class="string">&quot;价格： &quot;</span> + <span class="built_in">str</span>(self.__price) + <span class="string">&quot;元&quot;</span> +</span><br><span class="line">              <span class="string">&quot;窗户： &quot;</span> + (<span class="string">&quot;有&quot;</span> <span class="keyword">if</span> self.__has_window <span class="keyword">else</span> <span class="string">&quot;没有&quot;</span>) +</span><br><span class="line">              <span class="string">&quot;厨房： &quot;</span> + (<span class="string">&quot;有&quot;</span> <span class="keyword">if</span> self.__has_kitchen <span class="keyword">else</span> <span class="string">&quot;没有&quot;</span>) +</span><br><span class="line">              <span class="string">&quot;浴室： &quot;</span> + (<span class="string">&quot;有&quot;</span> <span class="keyword">if</span> self.__has_bathroom <span class="keyword">else</span> <span class="string">&quot;没有&quot;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HousingAgency</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self.__house_infos = []</span><br><span class="line">        self.__name = name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_name</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_houseinfo</span>(<span class="params">self, houseinfo</span>):</span></span><br><span class="line">        <span class="keyword">if</span> houseinfo <span class="keyword">not</span> <span class="keyword">in</span> self.__house_infos:</span><br><span class="line">            self.__house_infos.append(houseinfo)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">remove_houseinfo</span>(<span class="params">self, houseinfo</span>):</span></span><br><span class="line">        <span class="keyword">for</span> info <span class="keyword">in</span> self.__house_infos:</span><br><span class="line">            <span class="keyword">if</span> info == houseinfo:</span><br><span class="line">                self.__house_infos.remove(info)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_search_condition</span>(<span class="params">self, description</span>):</span></span><br><span class="line">        <span class="keyword">return</span> description</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_match_infos</span>(<span class="params">self, search_condition</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(self.get_name(), <span class="string">&quot;为您找到一下最合适的房源：&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> info <span class="keyword">in</span> self.__house_infos:</span><br><span class="line">            info.show_info()</span><br><span class="line">        <span class="keyword">return</span> self.__house_infos</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sign_contract</span>(<span class="params">self, houseinfo, period</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(self.get_name(), <span class="string">&quot;与房东&quot;</span>, houseinfo.get_onwer_name(), <span class="string">&quot;签订&quot;</span>, houseinfo.get_address(), <span class="string">&quot;的房子合同，租期为：&quot;</span>, period, <span class="string">&quot;年, 租期内&quot;</span>, self.get_name(), <span class="string">&quot;有权对其进行使用和转租！&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sign_contracts</span>(<span class="params">self, period</span>):</span></span><br><span class="line">        <span class="keyword">for</span> info <span class="keyword">in</span> self.__house_infos:</span><br><span class="line">            self.sign_contract(info, period)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HouseOwner</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self.__name = name</span><br><span class="line">        self.__houseinfo = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_name</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_houseinfo</span>(<span class="params">self,  area, price, has_window, has_bathroom, has_kitchen, address, owner</span>):</span></span><br><span class="line">        self.__houseinfo = HouseInfo(area, price, has_window, has_bathroom, has_kitchen, address, owner)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">public_houseinfo</span>(<span class="params">self, agency</span>):</span></span><br><span class="line">        agency.add_houseinfo(self.__houseinfo)</span><br><span class="line">        <span class="built_in">print</span>(self.get_name(), <span class="string">&quot;在&quot;</span>, agency.get_name(), <span class="string">&quot;发布房源出租信息&quot;</span>)</span><br><span class="line">        self.__houseinfo.show_info()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Customer</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self.__name = name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_name</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">find_house</span>(<span class="params">self, description, agency</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;我是&quot;</span> + self.get_name() + <span class="string">&quot;，我想找一个&quot;</span>, description , <span class="string">&quot;的房子&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>()</span><br><span class="line">        <span class="keyword">return</span> agency.get_match_infos(agency.get_search_condition(description))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">see_house</span>(<span class="params">self, houseinfos</span>):</span></span><br><span class="line">        size = <span class="built_in">len</span>(houseinfos)</span><br><span class="line">        <span class="keyword">return</span> houseinfos[size-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sign_contract</span>(<span class="params">self, houseinfo, agency, period</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(self.get_name(), <span class="string">&quot;与中介&quot;</span>, agency.get_name(), <span class="string">&quot;签订&quot;</span>, houseinfo.get_address(), <span class="string">&quot;的房子的组人合同，租期&quot;</span>, period, <span class="string">&quot;年，合同期内&quot;</span>, self.__name , <span class="string">&quot;有权使用！&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    myhome = HousingAgency(<span class="string">&quot;我爱你家&quot;</span>)</span><br><span class="line">    zhangsan = HouseOwner(<span class="string">&quot;张三&quot;</span>)</span><br><span class="line">    zhangsan.set_houseinfo(<span class="number">20</span>, <span class="number">2600</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>, <span class="string">&quot;上地犀利&quot;</span>, zhangsan)</span><br><span class="line">    zhangsan.public_houseinfo(myhome)</span><br><span class="line"></span><br><span class="line">    lisi = HouseOwner(<span class="string">&quot;李四&quot;</span>)</span><br><span class="line">    lisi.set_houseinfo(<span class="number">30</span>, <span class="number">3800</span>, <span class="literal">True</span>, <span class="literal">True</span>, <span class="literal">True</span>, <span class="string">&quot;西二旗的太阳&quot;</span>, lisi)</span><br><span class="line">    lisi.public_houseinfo(myhome)</span><br><span class="line"></span><br><span class="line">    wangwu = HouseOwner(<span class="string">&quot;王五&quot;</span>)</span><br><span class="line">    wangwu.set_houseinfo(<span class="number">40</span>, <span class="number">5200</span>, <span class="literal">True</span>, <span class="literal">True</span>, <span class="literal">True</span>, <span class="string">&quot;东直门的艾利欧&quot;</span>, wangwu)</span><br><span class="line">    wangwu.public_houseinfo(myhome)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">    myhome.sign_contracts(<span class="number">3</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">    tony = Customer(<span class="string">&quot;Tony&quot;</span>)</span><br><span class="line">    houseinfos = tony.find_house(<span class="string">&quot;18平方米，要有独立卫生间，要有窗户，最好朝南，有厨房更好！价位200左右&quot;</span>, myhome)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;正在看房，寻找最合适的房子&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">    appropriate_house = tony.see_house(houseinfos)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">    tony.sign_contract(appropriate_house, myhome, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>主要代码，没有主要代码，上述案例只是一种体现中介模式的方式，中介将个人与房东联合的操作聚合在一个类中，方便了个人与房东，但是复杂了中介类。</p>
</li>
<li><p>设备驱动案例</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> abc <span class="keyword">import</span> ABCMeta, abstractmethod</span><br><span class="line"><span class="keyword">from</span> enum <span class="keyword">import</span> Enum</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DeviceType</span>(<span class="params">Enum</span>):</span></span><br><span class="line">    TypeSpeaker = <span class="number">1</span></span><br><span class="line">    TypeMicrophone = <span class="number">2</span></span><br><span class="line">    TypeCamera = <span class="number">3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DeviceItem</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, <span class="built_in">id</span>, name, <span class="built_in">type</span>, isDefault=<span class="literal">False</span></span>):</span></span><br><span class="line">        self.__<span class="built_in">id</span> = <span class="built_in">id</span></span><br><span class="line">        self.__name = name</span><br><span class="line">        self.__<span class="built_in">type</span> = <span class="built_in">type</span></span><br><span class="line">        self.__isDefault = isDefault</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;type: &quot;</span> + <span class="built_in">str</span>(self.__<span class="built_in">type</span>) + <span class="string">&quot;id: &quot;</span> + <span class="built_in">str</span>(self.__<span class="built_in">id</span>) + <span class="string">&quot;name: &quot;</span> + <span class="built_in">str</span>(</span><br><span class="line">            self.__name) + <span class="string">&quot;isDefault: &quot;</span> + <span class="built_in">str</span>(self.__isDefault)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getId</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__<span class="built_in">id</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getNmae</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getType</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__<span class="built_in">type</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isDefault</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__isDefault</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DeviceList</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.__devices = []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">self, deviceItem</span>):</span></span><br><span class="line">        self.__devices.append(deviceItem)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getCount</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.__devices)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getByIdx</span>(<span class="params">self, idx</span>):</span></span><br><span class="line">        <span class="keyword">if</span> idx &lt; <span class="number">0</span> <span class="keyword">or</span> idx &gt;= self.getCount():</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">return</span> self.__devices[idx]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getById</span>(<span class="params">self, <span class="built_in">id</span></span>):</span></span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> self.__devices:</span><br><span class="line">            <span class="keyword">if</span> item.getId() == <span class="built_in">id</span>:</span><br><span class="line">                <span class="keyword">return</span> item</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DeviceMgr</span>(<span class="params">metaclass=ABCMeta</span>):</span></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">enumerate</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">active</span>(<span class="params">self, deviceId</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getCurDeviceId</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SpeakerMgr</span>(<span class="params">DeviceMgr</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.__curDeviceId = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">enumerate</span>(<span class="params">self</span>):</span></span><br><span class="line">        devices = DeviceList()</span><br><span class="line">        devices.add(</span><br><span class="line">            DeviceItem(<span class="string">&quot;37dd1024-843b-83a1-934c-81ac9230111&quot;</span>, <span class="string">&quot;Realtek HighDefinition Audio&quot;</span>, DeviceType.TypeSpeaker,</span><br><span class="line">                       <span class="literal">True</span>))</span><br><span class="line">        devices.add(</span><br><span class="line">            DeviceItem(<span class="string">&quot;215a41c60-1313-24aa-1241-324ac3f445&quot;</span>, <span class="string">&quot;NVIDIA HighDefinition Audio&quot;</span>, DeviceType.TypeSpeaker,</span><br><span class="line">                       <span class="literal">True</span>))</span><br><span class="line">        <span class="keyword">return</span> devices</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">active</span>(<span class="params">self, deviceId</span>):</span></span><br><span class="line">        self.__curDeviceId = deviceId</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getCurDeviceId</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__curDeviceId</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DeviceUtil</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.__mgrs = &#123;DeviceType.TypeSpeaker: SpeakerMgr()&#125;</span><br><span class="line">        <span class="comment"># self.__microphoneMgr =</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getDeviceMgr</span>(<span class="params">self, <span class="built_in">type</span></span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__mgrs[<span class="built_in">type</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getDeviceList</span>(<span class="params">self, <span class="built_in">type</span></span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__getDeviceMgr(<span class="built_in">type</span>).<span class="built_in">enumerate</span>()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">active</span>(<span class="params">self, <span class="built_in">type</span>, deviceId</span>):</span></span><br><span class="line">        self.__getDeviceMgr(<span class="built_in">type</span>).active(deviceId)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getCurDeviceId</span>(<span class="params">self, <span class="built_in">type</span></span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__getDeviceMgr(<span class="built_in">type</span>).getCurDeviceId()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    deviceUtil = DeviceUtil()</span><br><span class="line">    deviceList = deviceUtil.getDeviceList(DeviceType.TypeSpeaker)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;麦克风设备列表：&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> devDeviceItemiceList.getCount() &gt; <span class="number">0</span>:</span><br><span class="line">        deviceUtil.active(DeviceType.TypeSpeaker, deviceList.getByIdx(<span class="number">0</span>).getId())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> idx <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, deviceList.getCount()):</span><br><span class="line">        device = deviceList.getByIdx(idx)</span><br><span class="line">        <span class="built_in">print</span>(device)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;当前使用的设备：&quot;</span> + deviceList.getById(deviceUtil.getCurDeviceId(DeviceType.TypeSpeaker)).getNmae())</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>分析，上述代码是将DeviceMgr作为中介，在一对多的关系中，DeviceItem是多，DeviceUtil是1，DeviceMgr将一个类型的驱动聚合，提供给DeviceUtil用。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DeviceItem</span><br><span class="line">DeviceMgr</span><br><span class="line">SpeakerMgr</span><br><span class="line">DeviceUtil</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="4-装饰模式"><a href="#4-装饰模式" class="headerlink" title="4. 装饰模式"></a>4. 装饰模式</h2><ul>
<li><p>装饰模式，可以让类在不改变自身的前提下添加更多功能</p>
</li>
<li><p>装饰模式实现的主要地方在于装饰类继承被装饰类、去嵌套执行被装饰者的方法并且额外扩充功能</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>(<span class="params">metaclass=ABCMeta</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self._name = name</span><br><span class="line"></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wear</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;着装：&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClothingDecorator</span>(<span class="params">Person</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, person</span>):</span></span><br><span class="line">        self._decorated = person</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wear</span>(<span class="params">self</span>):</span></span><br><span class="line">        self._decorated.wear()</span><br><span class="line">        self.decorate()</span><br><span class="line"></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decorate</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CasulPantDecorator</span>(<span class="params">ClothingDecorator</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, person</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(person)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decorate</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;一条卡其色休闲裤&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    tony = Engineer(<span class="string">&quot;Tony&quot;</span>, <span class="string">&quot;客户端开发&quot;</span>)</span><br><span class="line">    pant = CasulPantDecorator(tony)</span><br><span class="line">    belt = BeltDecorator(pant)</span><br><span class="line">    shoes = LeatherShoesDecorator(belt)</span><br><span class="line">    sweater = KnittedSweaterDecorator(shoes)</span><br><span class="line">    glasses = GlassedDecorator(sweater)</span><br><span class="line">    glasses.wear()</span><br></pre></td></tr></table></figure></li>
<li><p>主要代码，主要在这个ClothingDecorator类上，可以递归继承，调用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClothingDecorator</span>(<span class="params">Person</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, person</span>):</span></span><br><span class="line">        self._decorated = person</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wear</span>(<span class="params">self</span>):</span></span><br><span class="line">        self._decorated.wear()</span><br><span class="line">        self.decorate()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    	</span><br></pre></td></tr></table></figure></li>
<li><p>装饰器，单例模式装饰器</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">singletonDecorator</span>(<span class="params">cls, *args, **kwargs</span>):</span></span><br><span class="line">    instance = &#123;&#125;</span><br><span class="line">    <span class="comment"># 创建一个字典，以类名作为键 实例作为值，当装饰器运行时先判断是否存在，如果存在则返回实例</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapperSingleton</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">        <span class="keyword">if</span> cls <span class="keyword">not</span> <span class="keyword">in</span> instance:</span><br><span class="line">            instance[cls] = cls(*args, **kwargs)</span><br><span class="line">        <span class="keyword">return</span> instance[cls]</span><br><span class="line">   	</span><br><span class="line">    <span class="keyword">return</span> wrapperSingleton</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="5-单例模式"><a href="#5-单例模式" class="headerlink" title="5. 单例模式"></a>5. 单例模式</h2><ul>
<li><p>单例模式，全局唯一实例</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyBeaultifulGril</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    __instance = <span class="literal">None</span></span><br><span class="line">    __isFirstInit = <span class="literal">False</span></span><br><span class="line">	</span><br><span class="line">    <span class="comment"># 魔术方法，调用前先判断是否已有实例</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span>(<span class="params">cls, name</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> cls.__instance:</span><br><span class="line">            MyBeaultifulGril.__instance = <span class="built_in">super</span>().__new__(cls)</span><br><span class="line">        <span class="keyword">return</span> cls.__instance</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.__isFirstInit:</span><br><span class="line">            self.__name = name</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;遇见&quot;</span> + name + <span class="string">&quot;, 我一见钟情&quot;</span>)</span><br><span class="line">            self.__isFirstInit = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;遇见&quot;</span> + name + <span class="string">&quot;, 我置若罔闻！&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">showMyHeart</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(self.__name + <span class="string">&quot;就是我心中的唯一！&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    jenny = MyBeaultifulGril(<span class="string">&quot;Jenney&quot;</span>)</span><br><span class="line">    jenny.showMyHeart()</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">    kimi = MyBeaultifulGril(<span class="string">&quot;kimi&quot;</span>)</span><br><span class="line">    kimi.showMyHeart()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;id(jenny):&quot;</span>, <span class="built_in">id</span>(jenny), <span class="string">&quot;id(kimi)&quot;</span>, <span class="built_in">id</span>(kimi))</span><br></pre></td></tr></table></figure></li>
<li><p>主要代码，使用python内置的模式方法实现单例</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 魔术方法，调用前先判断是否已有实例</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__new__</span>(<span class="params">cls, name</span>):</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> cls.__instance:</span><br><span class="line">        MyBeaultifulGril.__instance = <span class="built_in">super</span>().__new__(cls)</span><br><span class="line">    <span class="keyword">return</span> cls.__instance</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="6-克隆模式"><a href="#6-克隆模式" class="headerlink" title="6.克隆模式"></a>6.克隆模式</h2><ul>
<li><p>克隆模式（也叫原型模式），主要用于克隆属性 ，python的克隆可以用类库来实现</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> copy <span class="keyword">import</span>  copy, deepcopy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, age</span>):</span></span><br><span class="line">        self.__name = name</span><br><span class="line">        self.__age = age</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">showMySelf</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;我是&quot;</span> + self.__name + <span class="string">&quot;,年龄&quot;</span> + <span class="built_in">str</span>(self.__age) + <span class="string">&quot;,&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">coding</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;我是码农，我用程序改变世界，Coding...&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reading</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;阅读是我快乐！知识是我成长！如饥似渴地阅读是生活的一部分....&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fallInLove</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;春风吹，月亮明，花前月下好相约....&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">clone</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> copy(self)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    tony = Person(<span class="string">&quot;Tony&quot;</span>, <span class="number">27</span>)</span><br><span class="line">    tony.showMySelf()</span><br><span class="line">    tony.coding()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">    tony1 = tony.clone()</span><br><span class="line">    tony1.showMySelf()</span><br><span class="line">    tony1.reading()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">    tony2 = tony.clone()</span><br><span class="line">    tony2.showMySelf()</span><br><span class="line">    tony2.fallInLove()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<ul>
<li>浅拷贝只拷贝应用类型对象的指针（指向），不开被引用类型对象指向的值；深拷贝则同事拷贝引用类型对象及其指向的值。</li>
</ul>
</li>
</ul>
<h2 id="7-职责模式"><a href="#7-职责模式" class="headerlink" title="7. 职责模式"></a>7. 职责模式</h2><ul>
<li><p>职责模式 ，解耦请求和处理端，请求端只需要知道下一级是谁即可，处理端只需要处理在自己范围内的事即可。</p>
</li>
<li><p>注意点：设计好下级处理对象，下级对象根据条件匹配，如果相符则执行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> abc <span class="keyword">import</span> ABCMeta, abstractmethod</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, dayoff, reason</span>):</span></span><br><span class="line">        self.__name = name</span><br><span class="line">        self.__dayoff = dayoff</span><br><span class="line">        self.__reason = reason</span><br><span class="line">        self.__leader = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getName</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getDayoff</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__dayoff</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getReason</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__reason</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setLeader</span>(<span class="params">self, leader</span>):</span></span><br><span class="line">        self.__leader = leader</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">request</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;%s 申请请假 %d 天,请假事由： %s&quot;</span> % (self.__name, self.__dayoff, self.__reason))</span><br><span class="line">        <span class="keyword">if</span> self.__leader <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            self.__leader.handleRequest(self)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Manager</span>(<span class="params">metaclass=ABCMeta</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, title</span>):</span></span><br><span class="line">        self.__name = name</span><br><span class="line">        self.__title = title</span><br><span class="line">        self._nextHandler = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getName</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getTitle</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__title</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setNextHandle</span>(<span class="params">self, nextHandler</span>):</span></span><br><span class="line">        self._nextHandler = nextHandler</span><br><span class="line"></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handleRequest</span>(<span class="params">self, person</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Supervisor</span>(<span class="params">Manager</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, title</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(name, title)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handleRequest</span>(<span class="params">self, person</span>):</span></span><br><span class="line">        <span class="keyword">if</span> person.getDayoff() &lt;= <span class="number">2</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;同意 %s 请假，签字人：%s (%s)&quot;</span> % (person.getName(), self.getName(), self.getTitle()))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self._nextHandler <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            self._nextHandler.handleRequest(person)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DepartmentManager</span>(<span class="params">Manager</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, title</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(name, title)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handleRequest</span>(<span class="params">self, person</span>):</span></span><br><span class="line">        <span class="keyword">if</span> person.getDayoff() &gt; <span class="number">2</span> <span class="keyword">and</span> person.getDayoff() &lt;= <span class="number">5</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;同意 %s 请假，签字人：%s (%s)&quot;</span> % (person.getName(), self.getName(), self.getTitle()))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self._nextHandler <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            self._nextHandler.handleRequest(person)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CEO</span>(<span class="params">Manager</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, title</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(name, title)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handleRequest</span>(<span class="params">self, person</span>):</span></span><br><span class="line">        <span class="keyword">if</span> person.getDayoff() &gt; <span class="number">5</span> <span class="keyword">and</span> person.getDayoff() &lt;= <span class="number">22</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;同意 %s 请假，签字人：%s (%s)&quot;</span> % (person.getName(), self.getName(), self.getTitle()))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self._nextHandler <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            self._nextHandler.handleRequest(person)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Administrator</span>(<span class="params">Manager</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, title</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init    <span class="comment"># 魔术方法，调用前先判断是否已有实例</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span>(<span class="params">cls, name</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> cls.__instance:</span><br><span class="line">            MyBeaultifulGril.__instance = <span class="built_in">super</span>().__new__(cls)</span><br><span class="line">        <span class="keyword">return</span> cls.__instance__(name, title)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handleRequest</span>(<span class="params">self, person</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;%s 的请假申请已审核，情况属实！已备案处理，处理人：%s(%s)\n&quot;</span> % (person.getName(), self.getName(), self.getTitle()))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    directLeader = Supervisor(<span class="string">&quot;Eren&quot;</span>, <span class="string">&quot;客户端研发部经理&quot;</span>)</span><br><span class="line">    departmentLeader = DepartmentManager(<span class="string">&quot;Eric&quot;</span>, <span class="string">&quot;技术研发中心总监&quot;</span>)</span><br><span class="line">    ceo = CEO(<span class="string">&quot;Helen&quot;</span>, <span class="string">&quot;创新文化公司CEO&quot;</span>)</span><br><span class="line">    administrator = Administrator(<span class="string">&quot;Nina&quot;</span>, <span class="string">&quot;行政中心总监&quot;</span>)</span><br><span class="line">    directLeader.setNextHandle(departmentLeader)</span><br><span class="line">    departmentLeader.setNextHandle(ceo)</span><br><span class="line">    ceo.setNextHandle(administrator)</span><br><span class="line"></span><br><span class="line">    sunny = Person(<span class="string">&quot;sunny&quot;</span>, <span class="number">1</span>, <span class="string">&quot;参加MDCC大会&quot;</span>)</span><br><span class="line">    sunny.setLeader(directLeader)</span><br><span class="line">    sunny.request()</span><br><span class="line"></span><br><span class="line">    tony = Person(<span class="string">&quot;tony&quot;</span>, <span class="number">5</span>, <span class="string">&quot;家里有紧急事情！&quot;</span>)</span><br><span class="line">    tony.setLeader(directLeader)</span><br><span class="line">    tony.request()</span><br><span class="line"></span><br><span class="line">    pony = Person(<span class="string">&quot;Pony&quot;</span>, <span class="number">15</span>, <span class="string">&quot;出国深造。&quot;</span>)</span><br><span class="line">    pony.setLeader(directLeader)</span><br><span class="line">    pony.request()</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>主要代码，链上的各个节点都设置好下一级的处理对象，各节点上的对象只有处理的条件符合时才处理。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Manager</span>(<span class="params">metaclass=ABCMeta</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, title</span>):</span></span><br><span class="line">        self._nextHandler = <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setNextHandle</span>(<span class="params">self, nextHandler</span>):</span></span><br><span class="line">        self._nextHandler = nextHandler</span><br><span class="line"></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handleRequest</span>(<span class="params">self, person</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> self._nextHandler <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            self._nextHandler.handleRequest(person)</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="8-代理模式"><a href="#8-代理模式" class="headerlink" title="8. 代理模式"></a>8. 代理模式</h2><ul>
<li><p>代理模式，间接执行真正的主体，协调双方也方便控制</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> abc <span class="keyword">import</span> ABCMeta, abstractmethod</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ReceiveParcel</span>(<span class="params">metaclass=ABCMeta</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self.__name = name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getName</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__name</span><br><span class="line"></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">receive</span>(<span class="params">self, parcelContent</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TonyReception</span>(<span class="params">ReceiveParcel</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, phoneNum</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(name)</span><br><span class="line">        self.__phoneNum = phoneNum</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getPhoneNum</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__phoneNum</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">receive</span>(<span class="params">self, parcelContent</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;货物主人： %s ,手机号： %s &quot;</span> % (self.getName(), self.getPhoneNum()))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;接收到一个包裹，包裹内容： %s &quot;</span> % parcelContent)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WendyReception</span>(<span class="params">ReceiveParcel</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, receiver</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(name)</span><br><span class="line">        self.__receiver = receiver</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">receive</span>(<span class="params">self, parcelContent</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;我是%s的朋友，我来帮他收快递！&quot;</span> %(self.__receiver.getName() + <span class="string">&quot; &quot;</span> ))</span><br><span class="line">        <span class="keyword">if</span> self.__receiver <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            self.__receiver.receive(parcelContent)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    tony = TonyReception(<span class="string">&quot;Tony&quot;</span>, <span class="string">&quot;18888888888&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Tony接受：&quot;</span>)</span><br><span class="line">    tony.receive(<span class="string">&quot;雪地靴&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Wendy代收：&quot;</span>)</span><br><span class="line">    wendy = WendyReception(<span class="string">&quot;Wendy&quot;</span>, tony)</span><br><span class="line">    wendy.receive(<span class="string">&quot;雪地靴&quot;</span>)</span><br></pre></td></tr></table></figure></li>
<li><p>主要代码，代理类传入需要代理的对象，在执行代理对象的方法之前可以进行控制处理。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WendyReception</span>(<span class="params">ReceiveParcel</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, receiver</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(name)</span><br><span class="line">        self.__receiver = receiver</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">receive</span>(<span class="params">self, parcelContent</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;我是%s的朋友，我来帮他收快递！&quot;</span> %(self.__receiver.getName() + <span class="string">&quot; &quot;</span> ))</span><br><span class="line">        <span class="keyword">if</span> self.__receiver <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            self.__receiver.receive(parcelContent)</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="9-外观模式"><a href="#9-外观模式" class="headerlink" title="9. 外观模式"></a>9. 外观模式</h2><ul>
<li><p>外观模式，也叫门户模式，将多个复杂的接口封装成一个，以供用户使用。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Register</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">register</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;活动中心： %s 同学报道成功！&quot;</span> % name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Payment</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pay</span>(<span class="params">self, name, money</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;缴费中心：收到%s同学%s元付款，缴费成功！&quot;</span> % (name, money))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DormitoryManagementCenter</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">provideLivingGoods</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;生活中心：%s 同学的生活用品已发放。&quot;</span> % name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dormitory</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">meetRoommate</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;宿舍： 大家好！这是刚来的 %s同学，是你们未来需要共读四年的室友！相互认识一下....&quot;</span> % name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Volunteer</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self.__name = name</span><br><span class="line">        self.__register = Register()</span><br><span class="line">        self.__payment = Payment()</span><br><span class="line">        self.__lifeCenter = DormitoryManagementCenter()</span><br><span class="line">        self.__dormintory = Dormitory()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">welcomeFreshmen</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;您好，%s同学！ 我是新生报到的志愿者%s,我将带你完成整个报道流程。&quot;</span> % (name, self.__name))</span><br><span class="line">        self.__register.register(name)</span><br><span class="line">        self.__payment.pay(name, <span class="number">10000</span>)</span><br><span class="line">        self.__lifeCenter.provideLivingGoods(name)</span><br><span class="line">        self.__dormintory.meetRoommate(name)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    volunteer = Volunteer(<span class="string">&quot;Frank&quot;</span>)</span><br><span class="line">    volunteer.welcomeFreshmen(<span class="string">&quot;tony&quot;</span>)</span><br></pre></td></tr></table></figure></li>
<li><p>主要代码，外观模式很像中介模式，将本来一对多的关系转换为一对一，由外观类去处理多，区别在于外观模式注重提供统一的对外接口，中介模式注重于双方的交互。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Volunteer</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self.__name = name</span><br><span class="line">        self.__register = Register()</span><br><span class="line">        self.__payment = Payment()</span><br><span class="line">        self.__lifeCenter = DormitoryManagementCenter()</span><br><span class="line">        self.__dormintory = Dormitory()</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="10-迭代模式"><a href="#10-迭代模式" class="headerlink" title="10 迭代模式"></a>10 迭代模式</h2><ul>
<li><p>迭代模式，提供一种对象的顺序访问方式，Python对迭代支持的非常好（for …. in）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Customer</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self.__name = name</span><br><span class="line">        self.__num = <span class="number">0</span></span><br><span class="line">        self.__clinics = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getName</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">register</span>(<span class="params">self, system</span>):</span></span><br><span class="line">        system.pushCustomer(self)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setNum</span>(<span class="params">self, num</span>):</span></span><br><span class="line">        self.__num = num</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getNum</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__num</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setClinic</span>(<span class="params">self, clinic</span>):</span></span><br><span class="line">        self.__clinics = clinic</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getClinic</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__clinics</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NumeralIterator</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, data</span>):</span></span><br><span class="line">        self.__data = data</span><br><span class="line">        self.__curIdx = -<span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.__curIdx &lt; <span class="built_in">len</span>(self.__data) -<span class="number">1</span>:</span><br><span class="line">            self.__curIdx += <span class="number">1</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">current</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__data[self.__curIdx] <span class="keyword">if</span> self.__curIdx &lt; <span class="built_in">len</span>(self.__data) <span class="keyword">and</span> self.__curIdx &gt;= <span class="number">0</span> <span class="keyword">else</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NumberalSystem</span>:</span></span><br><span class="line">    __clinics = (<span class="string">&quot;1号诊室&quot;</span>, <span class="string">&quot;2号正式诊室&quot;</span>, <span class="string">&quot;3号正式诊室&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self.__customers = []</span><br><span class="line">        self.__curNum = <span class="number">0</span></span><br><span class="line">        self.__name = name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pushCustomer</span>(<span class="params">self, customer</span>):</span></span><br><span class="line">        customer.setNum(self.__curNum + <span class="number">1</span>)</span><br><span class="line">        click = NumberalSystem.__clinics[self.__curNum % <span class="built_in">len</span>(NumberalSystem.__clinics)]</span><br><span class="line">        customer.setClinic(click)</span><br><span class="line">        self.__curNum += <span class="number">1</span></span><br><span class="line">        self.__customers.append(customer)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;%s 您好！ 您已在 %s 成功挂号，序号：%04d，请耐心等待！&quot;</span> % (customer.getName(), self.__name, customer.getNum()))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getIterator</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> NumeralIterator(self.__customers)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    numeralSystem = Nclass Volunteer:</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self.__name = name</span><br><span class="line">        self.__register = Register()</span><br><span class="line">        self.__payment = Payment()</span><br><span class="line">        self.__lifeCenter = DormitoryManagementCenter()</span><br><span class="line">        self.__dormintory = Dormitory()umberalSystem(<span class="string">&quot;挂号台&quot;</span>)</span><br><span class="line">    lily = Customer(<span class="string">&quot;Lily&quot;</span>)</span><br><span class="line">    lily.register(numeralSystem)</span><br><span class="line">    pony = Customer(<span class="string">&quot;Pony&quot;</span>)</span><br><span class="line">    pony.register(numeralSystem)</span><br><span class="line">    nick = Customer(<span class="string">&quot;Nick&quot;</span>)</span><br><span class="line">    nick.register(numeralSystem)</span><br><span class="line">    tony = Customer(<span class="string">&quot;Tony&quot;</span>)</span><br><span class="line">    tony.register(numeralSystem)<span class="class"><span class="keyword">class</span> <span class="title">WendyReception</span>(<span class="params">ReceiveParcel</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, receiver</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(name)</span><br><span class="line">        self.__receiver = receiver</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">receive</span>(<span class="params">self, parcelContent</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;我是%s的朋友，我来帮他收快递！&quot;</span> %(self.__receiver.getName() + <span class="string">&quot; &quot;</span> ))</span><br><span class="line">        <span class="keyword">if</span> self.__receiver <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            self.__receiver.receive(parcelContent)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">    iterator = numeralSystem.getIterator()</span><br><span class="line">    <span class="keyword">while</span>(iterator.<span class="built_in">next</span>()):</span><br><span class="line">        customer = iterator.current()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;下一位病人 %04d(%s) 请到 %s 就诊。&quot;</span> % (customer.getNum(), customer.getName(), customer.getClinic()))</span><br></pre></td></tr></table></figure></li>
<li><p>主要代码，没什么好说的，在其他语言里面这是一种数据、对象的遍历方式，在python里面也是，只不过python内置很多迭代器。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NumeralIterator</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, data</span>):</span></span><br><span class="line">        self.__data = data</span><br><span class="line">        self.__curIdx = -<span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.__curIdx &lt; <span class="built_in">len</span>(self.__data) -<span class="number">1</span>:</span><br><span class="line">            self.__curIdx += <span class="number">1</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">current</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__data[self.__curIdx] <span class="keyword">if</span> self.__curIdx &lt; <span class="built_in">len</span>(self.__data) <span class="keyword">and</span> self.__curIdx &gt;= <span class="number">0</span> <span class="keyword">else</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="11-组合模式"><a href="#11-组合模式" class="headerlink" title="11 组合模式"></a>11 组合模式</h2><ul>
<li><p>组合模式，复杂的功能可以分解成多个组件，组件之间相互组合构成更多功能。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> abc <span class="keyword">import</span> ABCMeta, abstractmethod</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ComputerComponent</span>(<span class="params">metaclass=ABCMeta</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self._name = name</span><br><span class="line"></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">showInfo</span>(<span class="params">self, indent=<span class="string">&quot; &quot;</span></span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isComposite</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">startup</span>(<span class="params">self, indent=<span class="string">&quot; &quot;</span></span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;%s%s 准备开始工作...&quot;</span> % (indent, self._name))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">shutdown</span>(<span class="params">self, indent=<span class="string">&quot; &quot;</span></span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;%s%s 即将结束工作...&quot;</span> % (indent, self._name))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CPU</span>(<span class="params">ComputerComponent</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(name)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">showInfo</span>(<span class="params">self, indent</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;%sCPU:%s,可以进行告诉运算。 &quot;</span> % (indent, self._name))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MemoryCard</span>(<span class="params">ComputerComponent</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(name)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">showInfo</span>(<span class="params">self, indent</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;%s内存:%s,可以缓存数据，读写更快。 &quot;</span> % (indent, self._name))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HardDisk</span>(<span class="params">ComputerComponent</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(name)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">showInfo</span>(<span class="params">self, indent</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;%s硬盘:%s,可以永久存储数据，容量大。 &quot;</span> % (indent, self._name))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GraphicsCard</span>(<span class="params">ComputerComponent</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(name)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">showInfo</span>(<span class="params">self, indent</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;%s显卡:%s,可以高速计算和处理图形图像。 &quot;</span> % (indent, self._name))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Battery</span>(<span class="params">ComputerComponent</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(name)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">showInfo</span>(<span class="params">self, indent</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;%s电源:%s,可以持续给主板和外界配件供电。 &quot;</span> % (indent, self._name))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fan</span>(<span class="params">ComputerComponent</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(name)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">showInfo</span>(<span class="params">self, indent</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;%s风扇:%s,可以持续给主板和外界配件供电。 &quot;</span> % (indent, self._name))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Displayer</span>(<span class="params">ComputerComponent</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(name)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">showInfo</span>(<span class="params">self, indent</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;%s显示器:%s,可以显示界面和打游戏。 &quot;</span> % (indent, self._name))</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ComputerComposite</span>(<span class="params">ComputerComponent</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(name)</span><br><span class="line">        self._components = []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">showInfo</span>(<span class="params">self, indent</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;%s,由一下部件组成：&quot;</span> % self._name)</span><br><span class="line">        indent += <span class="string">&#x27;\t&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> element <span class="keyword">in</span> self._components:</span><br><span class="line">            element.showInfo(indent)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isComposite</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">addComposite</span>(<span class="params">self, component</span>):</span></span><br><span class="line">        self._components.append(component)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">removeComponent</span>(<span class="params">self, component</span>):</span></span><br><span class="line">        self._components.remove(component)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">startup</span>(<span class="params">self, indent</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().startup(indent)</span><br><span class="line">        indent += <span class="string">&#x27;\t&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> element <span class="keyword">in</span> self._components:</span><br><span class="line">            element.startup(indent)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">shutdown</span>(<span class="params">self, indent</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().shutdown(indent)</span><br><span class="line">        indent += <span class="string">&#x27;\t&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> element <span class="keyword">in</span> self._components:</span><br><span class="line">            element.shutdown(indent)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainBoard</span>(<span class="params">ComputerComposite</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(name)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">showInfo</span>(<span class="params">self, indent</span>):</span>组合模式</span><br><span class="line">        <span class="built_in">print</span>(indent + <span class="string">&quot;主板：&quot;</span>, end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="built_in">super</span>().showInfo(indent)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ComputerCase</span>(<span class="params">ComputerComposite</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(name)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">showInfo</span>(<span class="params">self, indent</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(indent + <span class="string">&quot;机箱:&quot;</span>, end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="built_in">super</span>().showInfo(indent)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Computer</span>(<span class="params">ComputerComposite</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(name)组合模式</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">showInfo</span>(<span class="params">self, indent</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(indent, <span class="string">&quot;电脑：&quot;</span>, end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="built_in">super</span>().showInfo(indent)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    mainBoard = MainBoard(<span class="string">&quot;GIGABYTE Z179M M-ATX&quot;</span>)</span><br><span class="line">    mainBoard.addComposite(CPU(<span class="string">&quot;Intel Core I5-5500k&quot;</span>))</span><br><span class="line">    mainBoard.addComposite(MemoryCard(<span class="string">&quot;Kingston Fury DDR4&quot;</span>))</span><br><span class="line">    mainBoard.addComposite(HardDisk(<span class="string">&quot;Kingston V300&quot;</span>))</span><br><span class="line">    mainBoard.addComposite(GraphicsCard(<span class="string">&quot;Colorful iGame750&quot;</span>))</span><br><span class="line"></span><br><span class="line">    computerCase = ComputerCase(<span class="string">&quot;SAMA MATX&quot;</span>)</span><br><span class="line">    computerCase.addComposite(mainBoard)</span><br><span class="line">    computerCase.addComposite(Battery(<span class="string">&quot;Anter VP 450P&quot;</span>))</span><br><span class="line">    computerCase.addComposite(Fan(<span class="string">&quot;DEEPCOOL 120T&quot;</span>))</span><br><span class="line"></span><br><span class="line">    computer = Computer(<span class="string">&quot;Tony DIV 电脑&quot;</span>)</span><br><span class="line">    computer.addComposite(computerCase)</span><br><span class="line">    computer.addComposite(Displayer(<span class="string">&quot;AOC Lv24XIP&quot;</span>))</span><br><span class="line"></span><br><span class="line">    computer.showInfo(<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n 开机过程&quot;</span>)</span><br><span class="line">    computer.startup(<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n 关机过程&quot;</span>)</span><br><span class="line">    computer.shutdown(<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>主要代码 ，组合模式注重于将多个零件相互组合成一个复杂的系统。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ComputerComposite</span>(<span class="params">ComputerComponent</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(name)</span><br><span class="line">        self._components = []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">showInfo</span>(<span class="params">self, indent</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">addComposite</span>(<span class="params">self, component</span>):</span></span><br><span class="line">        self._components.append(component)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">removeComponent</span>(<span class="params">self, component</span>):</span></span><br><span class="line">        self._components.remove(component)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">startup</span>(<span class="params">self, indent</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">shutdown</span>(<span class="params">self, indent</span>):</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
</div><script src="/js/jquery.min.js"></script><script src="/js/main.js"></script></body></html>